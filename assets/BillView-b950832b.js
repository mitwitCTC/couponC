import{_ as p,v as d,r as h,o as l,c as r,a as t,t as c,b as a,d as b,n as f,e as y,w as x,f as _,g as m,F as v}from"./index-9ea18aad.js";const g="/couponC/assets/icons8-info-success-38adac5f.svg";const M={data(){return{bill:{station:"群和智慧MitWit",plate:"",fee:"180",arr_time:"2023-09-05 13:30:00"},isScan:!0,discount:{qrcode:"",amount:""},error:""}},components:{QrStream:d.QrStream,QrCapture:d.QrCapture,QrDropzone:d.QrDropzone},methods:{search(){this.bill.plate=localStorage.getItem("plate")},openModal(){const e=this.$refs.discountModal;new bootstrap.Modal(e).show()},hideModal(){const e=this.$refs.discountModal;bootstrap.Modal.getInstance(e).hide()},scanInput(){this.isScan=!this.isScan},async onInit(e){try{await e}catch(s){s.name==="NotAllowedError"?this.error="您需要允許鏡頭權限":s.name==="NotFoundError"?this.error="本裝置無鏡頭":s.name==="NotSupportedError"?this.error="操作失敗(https)":s.name==="NotReadableError"?this.error="相機正在使用中?":s.name==="OverconstrainedError"?this.error="裝置相機未安裝成功":s.name==="StreamApiNotSupportedError"&&(this.error="請嘗試使用別的瀏覽器操作")}},onDecode(e){this.discount.qrcode="coupon://"+e,this.discount.amount="0",this.getDiscount()},getDiscount(){this.bill.fee=50,this.discount={},this.hideModal(),this.search()}},mounted(){this.search()}},w=t("header",null,[t("div",{class:"bg-dark text-white text-center py-3"},"停車費折抵")],-1),C={class:"container mt-2"},I={class:"plate-img"},S={class:"bill p-4"},k={class:"border-bottom"},D=t("p",{class:"text-secondary"},"應繳金額",-1),N={class:"text-center"},E={class:"fs-3"},Q={class:"mt-2"},V={class:"text-secondary"},q={class:"text-primary"},B={class:"text-secondary"},F={class:"text-primary"},j={key:0,class:"warningInfo"},z=t("p",{class:"text-success fs-6 mt-1"},[t("img",{src:g,alt:"info-icon"}),a(" 無需繳費，請儘速離場，謝謝！")],-1),A=[z],T={class:"btns d-flex justify-content-around"},R={class:"modal",tabindex:"-1",id:"discountModal",ref:"discountModal"},U={class:"modal-dialog modal-sm modal-dialog-centered"},O={class:"modal-content"},W={class:"modal-body"},G={key:0,class:"scan d-flex flex-column align-items-center"},H={class:"stream"},J=t("div",{style:{color:"red"},class:"frame"},null,-1),K={key:0,class:"text-warning"},L={key:1},P={key:1},X={class:"mb-3"},Y=t("label",{for:"exampleFormControlInput1",class:"form-label"},[a("折扣券號碼或發票號碼"),t("span",{class:"text-danger"},"*")],-1),Z={class:"mb-3"},$=t("label",{for:"exampleFormControlInput1",class:"form-label"},"發票金額",-1),tt=t("small",{class:"text-secondary"},"若為折扣券，則金額請輸入 0",-1),st={class:"modal-footer"},ot={class:"d-flex justify-content-between"},et={class:"d-flex justify-content-between"},nt=t("button",{type:"button",class:"btn btn-sm btn-outline-secondary me-1","data-bs-dismiss":"modal"},"取消",-1);function it(e,s,lt,rt,o,i){const u=h("qr-stream");return l(),r(v,null,[w,t("div",C,[t("div",I,c(o.bill.plate),1),t("section",S,[t("section",k,[D,t("p",N,[a("NT$ "),t("span",E,c(o.bill.fee),1)])]),t("section",Q,[t("p",V,[a("停車地點"),t("span",q,"　"+c(o.bill.station),1)]),t("p",B,[a("進場時間"),t("span",F,"　"+c(o.bill.arr_time),1)])]),o.bill.fee==0?(l(),r("div",j,A)):b("",!0),t("div",T,[t("button",{class:"btn btn-primary",id:"toggleMyModal",onClick:s[0]||(s[0]=n=>i.openModal())},"發票折抵"),t("button",{class:f(["btn",o.bill.fee==0?"btn-secondary":"btn-primary"])},"繳費離場",2)]),t("div",R,[t("div",U,[t("div",O,[t("div",W,[o.isScan?(l(),r("div",G,[t("div",H,[y(u,{onInit:i.onInit,onDecode:i.onDecode,class:"mb"},{default:x(()=>[J]),_:1},8,["onInit","onDecode"])]),o.error?(l(),r("p",K,c(o.error),1)):(l(),r("p",L,"掃描中..."))])):(l(),r("div",P,[t("div",X,[Y,_(t("input",{type:"text",class:"form-control",id:"discountQrcode",placeholder:"請輸入折扣券號碼或發票號碼","onUpdate:modelValue":s[1]||(s[1]=n=>o.discount.qrcode=n)},null,512),[[m,o.discount.qrcode]])]),t("div",Z,[$,_(t("input",{type:"text",class:"form-control",id:"discountAmount",placeholder:"請輸入發票金額","onUpdate:modelValue":s[2]||(s[2]=n=>o.discount.amount=n)},null,512),[[m,o.discount.amount]]),tt])]))]),t("div",st,[t("div",ot,[t("button",{class:"btn btn-primary me-4",onClick:s[3]||(s[3]=(...n)=>i.scanInput&&i.scanInput(...n))},c(o.isScan?"手動輸入":"掃描輸入"),1),t("div",et,[nt,t("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:s[4]||(s[4]=n=>i.getDiscount())},"確認")])])])])])],512)])])],64)}const at=p(M,[["render",it]]);export{at as default};
